{% extends "base.html" %}

{% block content %}
<script src="//cdn.jsdelivr.net/phaser/2.5.0/phaser.min.js"></script>
<div class='main_desc'>
	<p><em>Insert Game Here</em></p>
	<script type="text/javascript">
		
		/*var game = new Phaser.Game(800, 600, Phaser.AUTO, '', { preload: preload, create: create, update: update });
		
		function preload() {
		
			game.stage.backgroundColor = '#000000';
		
			game.load.baseURL = 'http://examples.phaser.io/assets/';
			game.load.crossOrigin = 'anonymous';
		
			game.load.image('player', 'sprites/phaser-dude.png');
			game.load.image('platform', 'sprites/platform.png');
			game.load.image('car','sprites/car.png')
		}
		var player;
		var platforms;
		var car;
		var cursors;
		
		function create() {
		
		
			player = game.add.sprite(400, 600, 'player');
			game.physics.arcade.enable(player);
			car = game.add.sprite(400, 0, 'car');
		
		
			player.body.collideWorldBounds = true;
			
		
		
			platforms = game.add.physicsGroup();
		
			platforms.create(500, 150, 'platform');
			platforms.create(200, 200, 'platform');
			platforms.create(0, 450, 'platform');
		
			platforms.setAll('body.immovable', true);
		
			cursors = game.input.keyboard.createCursorKeys();
		
		}
		function update () {
		
			game.physics.arcade.collide(player, platforms);
		
			game.physics.arcade.overlap(car, player, win);
			
			function win (player, car){
				game.add.text(16, 16, 'You WIN!', { fontSize: '32px', fill: '#000' })
			}
			
			player.body.velocity.x = 0;
			player.body.velocity.y = 0;
		
		
			if (cursors.left.isDown)
			{
				player.body.velocity.x = -250;
			}
			else if (cursors.right.isDown)
			{
				player.body.velocity.x = 250;
			}
			else if (cursors.up.isDown)
			{
				player.body.velocity.y = -250;
			}
			else if (cursors.down.isDown)
			{
				player.body.velocity.y = 250;
			}
		}
		function render () {
		
		}*/

        var game = new Phaser.Game(800, 640, Phaser.CANVAS, '', { preload: preload, create: create, update: update, render: render});

        function preload() {

            game.load.image('background', '/static/images/LevelOneFinal.png');
            game.load.spritesheet('ball', '/static/images/redBall.png');
            game.load.spritesheet('peg', '/static/images/block.png');


        }

        var background;
        var pegs;
        var ball;
        var block;
        var cursors;

        function create() {

            game.physics.startSystem(Phaser.Physics.ARCADE);
            game.stage.backgroundColor = '#eeeeee';


            var backgroundLayer = game.add.group();

            //create group for all the pegs
            pegs = game.add.group();
            pegs.enableBody = true;

            background = backgroundLayer.create(0,0, 'background');

            //create and modify ball
            ball = game.add.sprite(400,50,'ball');
            ball.scale.setTo(0.1);
            ball.anchor.setTo(0.5);

            //place pegs all over map randomly
            var num = 200

            for (var i = 0; i < 5; i++ ) {
                createLayerPegs(num)
                num += 50;
            }



            //enable physics for x objects
            game.physics.enable([ball]);

            //ball physics
            ball.body.bounce.set(0.4);
            ball.body.collideWorldBounds = true;
            ball.body.onCollide = new Phaser.Signal();

            cursors = game.input.keyboard.createCursorKeys();

        }


        function update () {

            //create collision detection for objects
            game.physics.arcade.collide(ball, pegs);

            if (cursors.left.isDown)
            {
                ball.body.x -= 4;
            }
            else if (cursors.right.isDown)
            {
                ball.body.x += 4;
            }

            if (game.input.activePointer.isDown)
            {
                actionOnClick()
            }

        }

        // On click, this will activate gravity for our ball object
        function actionOnClick () {

            game.physics.arcade.gravity.y = 100;

        }

        function createLayerPegs (worldY) {

            var worldX = game.rnd.integerInRange(80,120);

            for ( var i = 0; i < 8; i++)
            {
                if (i == 0) {
                    block = pegs.create(worldX, worldY , 'peg');
                }

                else {
                    worldX += game.rnd.integerInRange(65,100);
                    block = pegs.create(worldX, worldY , 'peg');
                }

                block.body.collideWorldBounds = true;
                block.body.immovable = true;
                block.body.moves = false;
            }
        }



        function render () {

        }
		
		
	</script>
</div>
{% endblock %}
